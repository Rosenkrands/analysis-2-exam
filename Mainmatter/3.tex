% !TEX root = ../main.tex
\subsection{Sætningen om inverse funktioner}

\begin{boks}{Sætning 8.3 (Sætningen om inverse funktioner)}
  Lad
  \begin{itemize}[label = $\ast$]
    \item $\underline{u}_0 \in U_0 \ \dot{\subset} \ \mathcal{O} \ \dot{\subset} \ \mathbb{R}^m$
    \item $g \in C^1(\mathcal{O}; \mathbb{R}^m)$ hvor $[Dg(u_0)]$ er invertibel
    \item $U_0$ er en kugle omkring $\underline{u}_0$ så $g_{|U_0}$ er injektiv
  \end{itemize}
  så findes $g(\underline{u}_0) \in E \ \dot{\subset} \ \mathbb{R}^m$, $f \in C^1(E; \mathbb{R}^m)$ og
  \begin{enumerate}[label = (\arabic*)]
    \item $V \ := \ g^{-1}_{|U_0} = f(E) \ \dot{\subset} \ \mathbb{R}^m$
    \item $g(f(w)) = w$ på $E$ og $f(g(u)) = u$ på $V$
    \item $[Dg(f(w))]$ er invertibel og $[Df(w)] = [Dg(f(w))]^{-1}$
  \end{enumerate}
\end{boks}
\begin{proof}
  $g_{|U_0}$ er injektiv som følge af Proposition 8.2

  Sæt
  $$U = U_0 \times \mathbb{R}^m \ \dot{\subset} \ \mathbb{R}^{m + m}$$
  $$h \in C^1(U; \mathbb{R}^m)$$ $$h(u,w) = g(u) - w$$
  Definér $a = [u_0, g(u_0)] = [u_0, w_0]$, således at $h(a) = 0$.

  \textbf{Ideen} er nu at vise at $h$ opfylder antagelserne i Sætningen om implicit givne funktioner
  \begin{enumerate}[label = (\arabic*)]
    \item $U \ \dot{\subset} \ \mathbb{R}^d$
    \item $h \ : \ U \rightarrow \mathbb{R}^m \in C^1(U; \mathbb{R}^m)$
    \item $h(a) = 0$ så $[D_uh(a)]$ er invertibel
  \end{enumerate}
  Differentier $h$ m.h.t. $u$
  $$[D_uh(u,w)] = [Dg(u)]$$
  indsæt $a$
  $$[D_uh(a)] = [Dg(u_0)]$$
  hvor vi ved at højre side er invertibel, derfor må venstre side også være det.

  Dermed er antagelserne i Sætninge om implicit givne funktioner opfyldt og vi ved derfor at der findes
  $$g(u_0) = w_0 \in E$$
  $$f \in C^1(E; \mathbb{R}^m)$$
  så
  \begin{align}
    h \Big( [f(w), w] \Big) &= 0 \nonumber\\
    g(f(w)) - w &= 0 \nonumber\\
    g(f(w)) &= w \label{kors}
  \end{align}
  Vi beviser først \textbf{(1)}, det gør vi ved at vise det følgende
  $$f(E) \subseteq g^{-1}_{|U_0}(E)
  \quad \text{og} \quad
  f(E) \supseteq g^{-1}_{|U_0}(E)$$
  Vi starter med $(\subseteq)$

  Lad $u \in f(E)$, dvs.
  $$\exists \ w \in E \quad : \quad u = f(w)$$
  ifølge \eqref{kors} må
  $$g(u) = w$$
  derfor kan vi konkludere at $g(u) \in E$ og dermed $u \in g^{-1}_{|U_0}(E)$.
  Dette leder os til konklusionen
  $$f(E) \subset g^{-1}_{|U_0}(E)$$

  Herefter tager vi $(\supseteq)$

  Lad $x \in g^{-1}_{|U_0}(E)$, dvs.
  $$\exists \ w \in E \quad : \quad w = g(x)$$
  hvilket vil sige, ifølge \eqref{kors}, at
  $$w = g(f(w))$$
  det medfører at
  $$f(w) = x$$
  $g_{|U_0}$ er injektiv, $f(w) \in U_0$ og vi kan derfor konkludere at
  $$g^{-1}_{|U_0}(E) \subseteq f(E)$$
  hvilket beviser \textbf{(1)}.

  Vi beviser nu \textbf{(2)}, men dog kun den ene vej da fremgangsmåden er den samme.

  Vælg $u \in V$, med andre ord
  $$\exists \ w \in E \quad : \quad w \in g(u)$$
  fra \eqref{kors} ser vi at
  $$g(f(w)) = w = g(u)$$
  og derfor må $f(w) = u$, hvis vi nu anvender $f$ på det ovenstående får vi
  $$f(g(u)) = u$$

  Vi beviser nu \textbf{(3)}

  Vi ved at $w  = g(f(w))$ resultatet fås ved at differentiere denne ligning
  \begin{align*}
    [D_ww] &= [D_w = g(f(w))] \\
    [I_m] &= [Dg(f(w))][Df(w)] \\
    [Dg(f(w))]^{-1} &= [Df(w)]
  \end{align*}
  hvilket konkluderer beviset.
\end{proof}
